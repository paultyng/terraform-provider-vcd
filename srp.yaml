---
schema_id: '1.0'

sources:
  source:
    typename: source_tree.git
    path: $(env:source_path)

input_templates:
  source:
    $(sources:source_uid):
      is_components_source: true
      incorporated: false
      usages: ["testing", "building"]

spdx_templates:
  spdx:
    package:
      supplier: "Organization: VMware"
      originator: "Organization: VMware"
      license_declared: "MPL-2.0"
      license_concluded: "MPL-2.0"
      home_page: "https://github.com/vmware/terraform-provider-vcd"
      short_summary: "Terraform VMware Cloud Director provider"
      detailed_description: "Terraform VMware Cloud Director provider"

outputs:
  file(org=terraform-provider-vcd.vcd.vmware.com,name=linux_amd64,version=$(env:version),build_id=$(env:build_id)):
    merge_input_templates:
      - source
    merge_spdx_template: spdx
    scanner_instances:
      - scanner: srpcli-go
        args: ["--go-mod=$(env:source_path)/go.mod", "--incorporated=false", "--usage=functionality", "--usage=testing"]
      - scanner: srpcli-syft
        args: ["--incorporated=true", "--usage=functionality" ]
